# This "input" configures a global authorization rule to enable public access to
# all models in this schema. Learn more about authorization rules here: https://docs.amplify.aws/cli/graphql/authorization-rules
input AMPLIFY { globalAuthRule: AuthRule = { allow: public } }

type DriverFeature @model
@auth(rules: [
  { allow: public, provider: apiKey, operations: [create, read] }
]) {
  id: ID!
  driverId: String! @index(name: "byDriver", queryField: "featuresByDriver", sortKeyFields: ["date"])
  date: AWSDate!
  miles: Float
  trips: Int
  durationH: Float
  speedMean: Float
  speedStd: Float
  harshBrakeRate: Float
  harshAccelRate: Float
  sharpTurnRate: Float
  nightPct: Float
  schoolZonePct: Float
  riskScore: Float
  premium: Float
  updatedAt: AWSDateTime
}

type TripEvent @model
@auth(rules: [
  { allow: public, provider: apiKey, operations: [create, read] }
]) {
  id: ID!
  driverId: String! @index(name: "eventsByDriver", queryField: "eventsByDriver", sortKeyFields: ["ts"])
  ts: AWSDateTime!
  speed: Float
  accel: Float
  brake: Float
  lat: Float
  lon: Float
}
